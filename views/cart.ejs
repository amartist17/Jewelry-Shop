<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/x-icon" href="assets/images/favicon.png"/>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/animate.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/chosen.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/font-awesome.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/pe-icon-7-stroke.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/jquery.scrollbar.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/lightbox.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/magnific-popup.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/slick.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/fonts/flaticon.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/megamenu.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/dreaming-attribute.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/style.css"/>
    <title>Cart</title>
</head>
<body>
    <%- include('header'); -%>
<div class="banner-wrapper has_background">
    <img src="assets/images/banner-for-all2.jpg"
         class="img-responsive attachment-1920x447 size-1920x447" alt="img">
    <div class="banner-wrapper-inner">
        <h1 class="page-title">Cart</h1>
        <div role="navigation" aria-label="Breadcrumbs" class="breadcrumb-trail breadcrumbs">
            <ul class="trail-items breadcrumb">
                <li class="trail-item trail-begin"><a href="/"><span>Home</span></a></li>
                <li class="trail-item trail-end active"><span>Cart</span>
                </li>
            </ul>
        </div>
    </div>
</div>
<main class="site-main main-container no-sidebar">
    <div class="container">
        <div class="row">
            <div class="main-content col-md-12">
                <div class="page-main-content">
                    <div class="kaycee">
                        <div class="kaycee-notices-wrapper"></div>
                        <form class="kaycee-cart-form">
                            <table class="shop_table shop_table_responsive cart kaycee-cart-form__contents"
                                   cellspacing="0">

                                <thead>
                                <tr>
                                    <th class="product-remove">&nbsp;</th>
                                    <th class="product-thumbnail">&nbsp;</th>
                                    <th class="product-name">Product</th>
                                    <!-- <th class="product-price">Price</th> -->
                                    <th class="product-subtotal">Discounted Price</th>
                                </tr>
                                </thead>
                                <tbody>
                                    <% if (cart) { %>
                                     <% let sum=0 %>
                                    <% cart.forEach(item => { sum+= item.discountedPrice%>
                                        <tr class="kaycee-cart-form__cart-item cart_item">
                                            <td class="product-remove">
                                                <a href="#"  data-item="<%= item.productId %>"
                                                   class="remove remove-from-cart" aria-label="Remove this item" 
                                                   data-product_sku="885B712">Ã—</a></td>
                                            <td class="product-thumbnail">
                                                <a href="#"><img
                                                        src="assets/images/apro134-1-600x778.jpg"
                                                        class="attachment-kaycee_thumbnail size-kaycee_thumbnail"
                                                        alt="img" width="600" height="778"></a></td>
                                            <td class="product-name" data-title="Product">
                                                <a href="/product/<%= item.productId %>"><%= item.name %></a></td>
                                            <!-- <td class="product-price" data-title="Price">
                                                <span class="kaycee-Price-amount amount" style="color: grey;"><span
                                                        class="kaycee-Price-currencySymbol">Rs</span><%= item.price %></span></td>
                                            -->
                                            <td class="product-subtotal" data-title="Total">
                                                <span class="kaycee-Price-amount amount"><span
                                                        class="kaycee-Price-currencySymbol">Rs</span><%= item.discountedPrice %></span></td>
                                        </tr>
                                    <% }) %>
                                
                               
                                </tbody>
                            </table>
                        </form>
                        <div class="cart-collaterals">
                            <div class="cart_totals ">
                                <h2>Cart totals</h2>
                                <table class="shop_table shop_table_responsive" cellspacing="0">
                                    <tbody>
                                    <tr class="cart-subtotal">
                                        <th>Subtotal</th>
                                        <td data-title="Subtotal"><span class="kaycee-Price-amount amount"><span
                                                class="kaycee-Price-currencySymbol">Rs</span><%= sum %></span></td>
                                    </tr>
                                    <tr class="order-total">
                                        <th>Total</th>
                                        <td data-title="Total"><strong><span
                                                class="kaycee-Price-amount amount"><span
                                                class="kaycee-Price-currencySymbol">Rs</span><%= sum %></span></strong>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <div class="kaycee-proceed-to-checkout">
                                    <a href="/checkout"
                                       class="checkout-button button alt kaycee-forward">
                                        Proceed to checkout</a>
                                </div>
                            </div>
                        </div>
                        <% } %>
                                
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
<%- include('footer'); -%>
<a href="#" class="backtotop active">
    <i class="flaticon-right-arrow"></i>
</a>
<script src="assets/js/jquery-1.12.4.min.js"></script>
<script src="assets/js/bootstrap.min.js"></script>
<script src="assets/js/chosen.min.js"></script>
<script src="assets/js/countdown.min.js"></script>
<script src="assets/js/jquery.scrollbar.min.js"></script>
<script src="assets/js/lightbox.min.js"></script>
<script src="assets/js/magnific-popup.min.js"></script>
<script src="assets/js/slick.js"></script>
<script src="assets/js/jquery.zoom.min.js"></script>
<script src="assets/js/threesixty.min.js"></script>
<script src="assets/js/jquery-ui.min.js"></script>
<script src="assets/js/mobilemenu.js"></script>
<script src="assets/js/functions.js"></script>
<script>
$(document).ready(function() {
  // Add a click event handler to the "Remove from Cart" link
  $(".remove-from-cart").on("click", function(event) {
    event.preventDefault(); // Prevent the default behavior of the anchor tag
    
    // Get the data-productId attribute value
    var productId = $(this).data("item");
    
    // Create a data object to send as JSON
    var requestData = {
      productId: productId
    };
    // alert(productId)
    // Send an AJAX POST request
    $.ajax({
      type: "POST",
      url: "/api/remove-from-cart",
      data: JSON.stringify(requestData),
      contentType: "application/json",
      success: function(response) {
        // Handle the success response here
        location.reload();
        // console.log("Item removed from cart:", response);
      },
   
    });
  });
});
</script>
</body>

</html>